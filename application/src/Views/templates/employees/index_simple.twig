{% extends "base.twig" %}

{% block page_actions %}
    <div class="btn-toolbar">
        <a href="/employees/create" class="btn btn-primary">
            <i class="fas fa-plus me-1"></i>Add Employee
        </a>
    </div>
{% endblock %}

{% block content %}
<div class="card">
    <div class="card-body">
        <table id="employeesTable" class="table table-striped table-hover">
            <thead class="table-dark">
                <tr>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Phone</th>
                    <th>University Unit</th>
                    <th>Job Title</th>
                    <th>Role Assignments</th>
                    <th>Created</th>
                    <th>Actions</th>
                </tr>
            </thead>
        </table>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
$(document).ready(function() {
    console.log('Simple DataTable initialization...');
    console.log('jQuery available:', typeof $ !== 'undefined');
    console.log('DataTables available:', typeof $.fn.DataTable !== 'undefined');
    console.log('Table element found:', $('#employeesTable').length > 0);
    
    // Test API endpoint directly first
    $.get('/employees/data', function(data) {
        console.log('Direct API test success:', data);
    }).fail(function(xhr, status, error) {
        console.error('Direct API test failed:', status, error);
    });
    
    // Simple DataTable configuration
    try {
        var table = $('#employeesTable').DataTable({
            processing: true,
            serverSide: true,
            ajax: '/employees/data',
            columns: [
                { data: 'name' },
                { data: 'email' },
                { data: 'phone' },
                { data: 'university_unit_name' },
                { data: 'job_title' },
                { data: 'business_owner_count' },
                { data: 'created_at' },
                { data: 'id' }
            ]
        });
        
        console.log('DataTable initialized successfully');
        
    } catch (error) {
        console.error('DataTable initialization error:', error);
    }
});
</script>
{% endblock %}
